{% extends "base.html" %}
{% block title %}–ë–∞–Ω–∫ —Å–∏–ª–ª–∞–±—É—Å–æ–≤{% endblock %}

{% block content %}
<div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-6">
  <div>
    <h1 class="text-2xl font-bold text-slate-800">–ë–∞–Ω–∫ —Å–∏–ª–ª–∞–±—É—Å–æ–≤</h1>
    <p class="text-slate-500 text-sm mt-1">–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–±–º–µ–Ω–∞ –æ–ø—ã—Ç–æ–º.</p>
  </div>
  <a href="{% url 'syllabi_list' %}" class="btn-secondary text-sm flex items-center gap-2">
    <i class="fas fa-arrow-left"></i> –ú–æ–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã
  </a>
</div>

<form method="get" class="card p-4 mb-6 bg-white shadow-sm border border-slate-200">
  <div class="grid gap-4 md:grid-cols-4">
    <div>
      <label class="block text-xs font-bold text-slate-500 uppercase mb-1">–ü–æ–∏—Å–∫</label>
      <input type="text" name="q" value="{{ filters.q }}" placeholder="–ö–æ–¥, –∫—É—Ä—Å, –∞–≤—Ç–æ—Ä..." class="form-control w-full border-slate-300 rounded-md text-sm">
    </div>
    <div>
      <label class="block text-xs font-bold text-slate-500 uppercase mb-1">–ö—É—Ä—Å</label>
      <select name="course" class="form-select w-full border-slate-300 rounded-md text-sm">
        <option value="">–í—Å–µ –∫—É—Ä—Å—ã</option>
        {% for item in course_options %}
          <option value="{{ item.course_id }}" {% if filters.course == item.course_id|stringformat:"s" %}selected{% endif %}>
            {{ item.course__code }}
          </option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label class="block text-xs font-bold text-slate-500 uppercase mb-1">–ê–≤—Ç–æ—Ä</label>
      <select name="creator" class="form-select w-full border-slate-300 rounded-md text-sm">
        <option value="">–í—Å–µ –∞–≤—Ç–æ—Ä—ã</option>
        {% for creator in creator_options %}
          <option value="{{ creator.id }}" {% if filters.creator == creator.id|stringformat:"s" %}selected{% endif %}>
            {{ creator.get_full_name|default:creator.username }}
          </option>
        {% endfor %}
      </select>
    </div>
    <div class="flex items-end gap-2">
      <button class="btn-primary w-full text-sm" type="submit">–ù–∞–π—Ç–∏</button>
      <a href="{% url 'shared_syllabi_list' %}" class="btn-secondary w-auto text-sm px-3">‚úï</a>
    </div>
  </div>
</form>

<div class="card overflow-hidden bg-white shadow-sm border border-slate-200 rounded-lg">
  <table class="w-full text-left text-sm">
    <thead class="bg-slate-50 text-slate-500 font-semibold border-b">
      <tr>
        <th class="p-4">–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞</th>
        <th class="p-4">–ê–≤—Ç–æ—Ä</th>
        <th class="p-4">–ì–æ–¥/–°–µ–º–µ—Å—Ç—Ä</th>
        <th class="p-4 text-right">–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-100">
    {% for syllabus in syllabi %}
      <tr class="hover:bg-slate-50 transition">
        <td class="p-4">
          <div class="font-bold text-slate-800">{{ syllabus.course.code }}</div>
          <div class="text-xs text-slate-500">{{ syllabus.course.title_ru|truncatechars:60 }}</div>
        </td>
        <td class="p-4 text-slate-700">
          <div class="flex items-center gap-2">
             <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-bold">
                 {{ syllabus.creator.first_name|first|default:"U" }}
             </div>
             {{ syllabus.creator.get_full_name|default:syllabus.creator.username }}
          </div>
        </td>
        <td class="p-4 text-slate-600">
          {{ syllabus.academic_year }} ({{ syllabus.semester }})
        </td>
        <td class="p-4 text-right flex justify-end gap-3 items-center">
          {% if syllabus.pdf_file %}
            <a href="{{ syllabus.pdf_file.url }}" target="_blank" class="text-slate-400 hover:text-blue-600 p-1" title="–°–∫–∞—á–∞—Ç—å PDF">
               <i class="fas fa-file-pdf"></i>
            </a>
          {% endif %}
          <a href="{% url 'syllabus_detail' syllabus.pk %}" class="btn-secondary px-3 py-1 text-xs">
            –û—Ç–∫—Ä—ã—Ç—å
          </a>
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="4" class="p-8 text-center text-slate-500">
          <div class="text-4xl mb-2 text-slate-300">üîç</div>
          –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∏–ª–ª–∞–±—É—Å–æ–≤ –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É.
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}